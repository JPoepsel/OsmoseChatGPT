<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Osmose Controller</title>

<link rel="stylesheet" href="/style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>


<body>

<nav>
  <button onclick="show('home')">Home</button>
  <button onclick="show('hist')">History</button>
  <button onclick="show('set')">Settings</button>
</nav>


<!-- ========================================================= -->
<!-- HOME -->
<!-- ========================================================= -->
<section id="home">

<h2 id="state">IDLE</h2>

<div class="grid">
  <div>TDS <b id="tds">0</b></div>
  <div>Liter <b id="liters">0</b></div>
  <div>Flow L/min <b id="flow">0</b></div>
  <div>  Rest
    <b id="left">0</b>
    <small id="timeLeft" style="display:block;font-size:14px;color:#aaa;">0m 0s</small>
  </div>

</div>

<button id="btnStart" class="start" onclick="startCmd()">Start</button>
<button id="btnStop"  class="stop"  onclick="stopCmd()">Stop</button>

</section>


<!-- ========================================================= -->
<!-- HISTORY -->
<!-- ========================================================= -->
<section id="hist" hidden>

<h3>üìà History</h3>

<select id="rangeSel">
  <option value="300">5 min</option>
  <option value="3600" selected>1 h</option>
  <option value="86400">24 h</option>
</select>

<canvas id="chart" height="140"></canvas>

<div id="lastValues" style="margin-top:10px;font-size:14px;"></div>

<h3 style="margin-top:20px;">Bez√ºge</h3>

<table id="histTable" border="1" cellspacing="0" cellpadding="4">
  <thead>
    <tr>
      <th>Start</th>
      <th>Stop</th>
      <th>Liter</th>
      <th>Grund</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

</section>



<!-- ========================================================= -->
<!-- SETTINGS -->
<!-- ========================================================= -->
<section id="set" hidden>

<h3>‚öô Settings</h3>

<div id="settings">

  <h3>Flow Calibration</h3>
  <label>Pulses/Liter IN <input id="pulsesPerLiterIn" type="number" step="0.1"></label>
  <label>Pulses/Liter OUT <input id="pulsesPerLiterOut" type="number" step="0.1"></label>

  <h3>Process</h3>
  <label>TDS Limit <input id="tdsLimit" type="number"></label>
  <label>Max. Flush Time (s) <input id="maxFlushTimeSec" type="number"></label>
  <label>Max Runtime AUTO (s)<input id="maxRuntimeAutoSec" type="number"></label>
  <label>Max Runtime MANUAL (s) <input id="maxRuntimeManualSec" type="number"></label>
  <label>Max Production AUTO (L) <input id="maxProductionAutoLiters" type="number" step="0.1"></label>
  <label>Max Production MANUAL (L) <input id="maxProductionManualLiters" type="number" step="0.1"></label>

  <h3>System</h3>
  <label><input id="autoStart" type="checkbox"> Auto Start</label>
  <label>MQTT Host <input id="mqttHost"></label>
  <label>MQTT Port <input id="mqttPort" type="number"></label>
  <label>mDNS Name <input id="mDNSName"></label>
 
 <label class="wifiRow">
    WiFi SSID
    <input id="wifiSSID" autocomplete="off">
    <button type="button" onclick="scanWifi()">Scan</button>
  </label>

  <div id="wifiResults" class="wifiResults" hidden></div>


  <label>
    WiFi Password
    <div class="pwWrap">
      <input id="wifiPassword" type="password">
      <span class="pwEye" onclick="togglePw('wifiPassword')">üëÅ</span>
    </div>
  </label>


  <label>
    AP Password
    <div class="pwWrap">
      <input id="APPassWord" type="password">
      <span class="pwEye" onclick="togglePw('APPassWord')">üëÅ</span>
    </div>
  </label>

  <br><br>
  <div class="settingsButtons">
    <div>
      <button onclick="saveSettings()">Save</button>
      <button onclick="saveAndReboot()">Save & Reboot</button>
    </div>

    <button class="save"
            onclick="location.href='/update'">
      Firmware update‚Ä¶
    </button>
  </div>

</div>

</section>



<script src="/app.js"></script>

</body>
</html>
