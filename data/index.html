<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Osmose Controller</title>

<link rel="stylesheet" href="style.css?v=2">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>


<body>

<nav>
  <button onclick="show('home')">Home</button>
  <button onclick="show('hist')">History</button>
  <button onclick="show('set')">Settings</button>
</nav>


<!-- ========================================================= -->
<!-- HOME -->
<!-- ========================================================= -->
<section id="home">

<h2 id="state">IDLE</h2>

<div class="grid">
  <div>TDS <b id="tds">0</b></div>
  <div>Liter <b id="liters">0</b></div>
  <div>Flow L/min <b id="flow">0</b></div>
  <div>Rest <b id="left">0</b></div>
</div>

<button id="btnStart" class="start" onclick="startCmd()">Start</button>
<button id="btnStop"  class="stop"  onclick="stopCmd()">Stop</button>

</section>


<!-- ========================================================= -->
<!-- HISTORY -->
<!-- ========================================================= -->
<section id="hist" hidden>

<h3>ðŸ“ˆ History</h3>

<select id="rangeSel">
  <option value="300">5 min</option>
  <option value="3600" selected>1 h</option>
  <option value="86400">24 h</option>
</select>

<canvas id="chart" height="140"></canvas>

<div id="lastValues" style="margin-top:10px;font-size:14px;"></div>

<h3 style="margin-top:20px;">BezÃ¼ge</h3>

<table id="histTable" border="1" cellspacing="0" cellpadding="4">
  <thead>
    <tr>
      <th>Start</th>
      <th>Stop</th>
      <th>Liter</th>
      <th>Grund</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

</section>



<!-- ========================================================= -->
<!-- SETTINGS -->
<!-- ========================================================= -->
<section id="set" hidden>

<h3>âš™ Settings</h3>

<div id="settings">

  <h3>Flow Calibration</h3>
  <label>Pulses/Liter IN <input id="pulsesPerLiterIn" type="number" step="0.1"></label>
  <label>Pulses/Liter OUT <input id="pulsesPerLiterOut" type="number" step="0.1"></label>

  <h3>Process</h3>
  <label>TDS Limit <input id="tdsLimit" type="number"></label>
  <label>Flush Time (s) <input id="flushTimeSec" type="number"></label>
  <label>Max Runtime (s) <input id="maxRuntimeSec" type="number"></label>
  <label>Max Production (L) <input id="maxProductionLiters" type="number" step="0.1"></label>

  <h3>System</h3>
  <label><input id="autoStart" type="checkbox"> Auto Start</label>
  <label>MQTT Host <input id="mqttHost"></label>
  <label>MQTT Port <input id="mqttPort" type="number"></label>
  <label>mDNS Name <input id="mDNSName"></label>
  <label>AP Password <input id="APPassWord" type="password"></label>

  <br><br>
  <button onclick="saveSettings()">Save Settings</button>

</div>

</section>



<!-- ========================================================= -->
<!-- IMPORTANT: only ONE script, no inline JS -->
<!-- ========================================================= -->
<script src="app.js?v=2"></script>

</body>
</html>
